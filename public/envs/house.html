<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>A House</title>
	<script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.0.1/dist/aframe-extras.min.js"></script>
	<script src="/envs/components/door.js"></script>
</head>
<body>
	<a-scene>
		<a-assets>
			<a-mixin id="wall-color" material="color: #731000"></a-mixin>
			<a-mixin id="roof-color" material="color: #373a40"></a-mixin>
			<a-mixin id="roof-beam" scale="6.3 .2 .2" material="color: #654321"></a-mixin>
			<a-asset-item id="door-model" src="/envs/models/door.gltf"></a-asset-item>
		</a-assets>
		<a-entity id="rig"
				  position="0 1 0"
				  rotation="0 0 0"
				  movement-controls="speed:0.1"
		>
			<a-entity id="camera"
					  camera
					  look-controls
			></a-entity>
			<a-entity cursor="rayOrigin: mouse"
			          raycaster="objects: .clickable"
			></a-entity>
			<a-entity id="laser-left"
					  laser-controls="hand: left"
			></a-entity>
			<a-entity id="laser-right"
			          laser-controls="hand: right"
					  raycaster="objects: .clickable"
					  line="color: green; opacity: .75"
			></a-entity>
		</a-entity>
		<a-entity id="house">
			<a-entity id="walls">
				<a-box position="-3 1.25 -5.5"
					   mixin="wall-color"
					   scale=".3 2.5 5"
				></a-box>
				<a-box position="3 1.25 -5.5"
					   mixin="wall-color"
					   scale=".3 2.5 5"
				></a-box>
				<a-box position="0 1.25 -8"
					   mixin="wall-color"
					   scale="6.3 2.5 0.3"
				></a-box>
				<a-box position="1.9 1.25 -3"
					   mixin="wall-color"
					   scale="2.5 2.5 0.3"
				></a-box>
				<a-box position="-1.9 1.25 -3"
					   mixin="wall-color"
					   scale="2.5 2.5 0.3"
				></a-box>
				<a-box position="0 2.1 -3"
					   mixin="wall-color"
					   scale="1.3 0.8 0.3"
				></a-box>
			</a-entity>
			<a-entity id="roof">
				<a-box mixin="roof-color"
					   position="-1.68777 2.9962 -5.5"
					   scale="3.64 0.1 6.3" 
					   rotation="0 0 20"
				></a-box>
				<a-box mixin="roof-color"
					   position="1.68777 2.9962 -5.5"
					   scale="3.64 0.1 6.3" 
					   rotation="0 0 -20"
				></a-box>
				<a-entity id="roof-wall-1"
				          position="0 2.5 -3"
				>
					<a-triangle mixin="wall-color"
					            position="0 0 0.15"
					            vertex-a="-3 0 0"
					            vertex-b="3 0 0"
					            vertex-c="0 1.05 0"
					></a-triangle>
					<a-triangle mixin="wall-color"
					            position="0 0 -0.15"
					            vertex-a="-3 0 0"
					            vertex-b="3 0 0"
					            vertex-c="0 1.05 0"
					            rotation="0 180 0"
					></a-triangle>
				</a-entity>
				<a-entity id="roof-wall-2"
				          position="0 2.5 -8"
				>
					<a-triangle mixin="wall-color"
					            position="0 0 0.15"
					            vertex-a="-3 0 0"
					            vertex-b="3 0 0"
					            vertex-c="0 1.05 0"
					></a-triangle>
					<a-triangle mixin="wall-color"
					            position="0 0 -0.15"
					            vertex-a="-3 0 0"
					            vertex-b="3 0 0"
					            vertex-c="0 1.05 0"
					            rotation="0 180 0"
					></a-triangle>
				</a-entity>
				<a-entity id="beams"
						  position="0 2.4 -5.5"
				>
					<a-box mixin="roof-beam"
					       position="0 0 0"
					></a-box>
					<a-box mixin="roof-beam"
					       position="0 0 1"
					></a-box>
					<a-box mixin="roof-beam"
					       position="0 0 -1"
					></a-box>
					<a-box mixin="roof-beam"
					       position="0 0 2"
					></a-box>
					<a-box mixin="roof-beam"
					       position="0 0 -2"
					></a-box>
				</a-entity>
			</a-entity>
			<a-entity id="door-pivot"
					  position="-0.65 0.85 -3"
					  animation="property: object3D.rotation.y; isRawProperty: true; to: 90; startEvents: doorclicked; delay:100"
			>
				<a-entity id="door"
						  gltf-model="#door-model"
						  door
						  class="clickable"
						  scale="0.01 0.01 0.01"
						  position="0.7283 -0.85 -0.11577"
				></a-entity>
			</a-entity>
		</a-entity>

		<a-plane position="0 0 -6"
				 rotation="-90 0 0" 
				 width="9" 
				 height="9"
				 color="#7BC8A4"
		></a-plane>
    	<a-sky color="#88aaff"></a-sky>
	</a-scene>
</body>
</html>